{"ast":null,"code":"var _jsxFileName = \"/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  _s();\n  // State declarations\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  // Refs\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n  // Initialize speech manager\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(playing => {\n        setIsPlaying(playing);\n      });\n      return () => {\n        if (speechManagerRef.current) {\n          speechManagerRef.current.stop();\n        }\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  // Initialize speech recognition support check\n  useEffect(() => {\n    const isSupported = 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;\n    setIsSpeechSupported(isSupported);\n  }, []);\n\n  // Auto-scroll to latest message\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [chatHistory]);\n\n  // Message handling functions\n  const handleSubmit = useCallback(async msg => {\n    if (msg.trim() === '' || msg === lastProcessedMessage.current) return;\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n\n    // Add user message\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"VirtualBudtender is thinking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingAnimation, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this),\n      id: loadingId,\n      isThinking: true\n    }]);\n    setIsLoading(true);\n    try {\n      const conversationHistoryForAPI = chatHistory.filter(message => !message.isThinking).map(message => ({\n        role: message.type === 'user' ? 'user' : 'assistant',\n        content: typeof message.content === 'string' ? message.content : 'Loading...'\n      }));\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n      const {\n        greeting,\n        products,\n        followUpQuestion,\n        recommendations\n      } = response.data;\n\n      // Format the response content\n      let formattedContent = greeting || '';\n      if (products !== null && products !== void 0 && products.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      // Remove thinking message and add response\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: recommendations.slice(0, 5) // ðŸ”¥ Limit initial view to 5\n        };\n\n        // Optional: trigger voice output\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => {\n            speakResponse(formattedContent.trim(), responseMessage.id);\n          }, TIMING.MESSAGE_DELAY);\n        }\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: \"I apologize, but I encountered a technical issue. Could you please try your request again?\",\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async product => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    setPlayingAudioId(id);\n    if (isRecording) {\n      var _recognition$current;\n      (_recognition$current = recognition.current) === null || _recognition$current === void 0 ? void 0 : _recognition$current.stop();\n      setIsRecording(false);\n    }\n    speechManagerRef.current.speak(text, () => setPlayingAudioId(id), () => setPlayingAudioId(null), () => {\n      console.error('Error speaking response');\n      setPlayingAudioId(null);\n    });\n  }, [isMuted, isRecording]);\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n    recognition.current.onresult = event => {\n      const transcript = Array.from(event.results).map(result => result[0].transcript).join('');\n      setCurrentSpeech(transcript);\n    };\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n    recognition.current.onerror = event => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback(preference => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n  const handleTextSubmit = e => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen bg-black flex flex-col overflow-hidden\",\n    children: [showPreferenceModal && /*#__PURE__*/_jsxDEV(PreferenceModal, {\n      onSelect: handlePreferenceSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 31\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/3 bg-black py-4 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/Runway-Pot-Cannabis.png\",\n            alt: \"Runway Pot Cannabis Logo\",\n            className: \"h-16 w-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-2/3 bg-[#f0b442]\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-black font-semibold text-sm\",\n                children: \"RUNWAY POTPILOT\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-black\",\n                children: \"How can I assist you today?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('text'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('voice'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Voice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: resetConversation,\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (speechManagerRef.current) {\n                    speechManagerRef.current.stop();\n                  }\n                  setIsMuted(!isMuted);\n                },\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 451,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 451,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-black/10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block md:w-1/3 bg-black relative\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full sticky top-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/Budtender.webp\",\n              alt: \"Virtual Budtender\",\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-ping w-4 h-4 bg-red-600 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-y-auto custom-scrollbar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6 space-y-4\",\n              children: [chatHistory.map(msg => /*#__PURE__*/_jsxDEV(Message, {\n                message: msg,\n                isUser: msg.type === 'user',\n                onPlayback: togglePlayback,\n                isPlaying: isPlaying,\n                playingAudioId: playingAudioId,\n                isMuted: isMuted,\n                recommendations: msg.recommendations,\n                onProductSelect: handleProductSelect,\n                onLike: productId => handleProductFeedback(productId, true),\n                onDislike: productId => handleProductFeedback(productId, false),\n                onCategorySelect: handleSubmit\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 488,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-black/10 p-6 bg-[#fcaf17]\",\n            children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleTextSubmit,\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: textInput,\n                onChange: e => setTextInput(e.target.value),\n                placeholder: \"Type your message here...\",\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 511,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",\n                disabled: isLoading || !textInput.trim(),\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 519,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 510,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                children: !isSpeechSupported ? \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\" : currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 529,\n                columnNumber: 19\n              }, this), isSpeechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRecording,\n                className: `w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${isRecording ? 'bg-red-500 animate-pulse' : 'bg-green-500 hover:bg-green-600'}`,\n                disabled: isLoading,\n                children: /*#__PURE__*/_jsxDEV(Mic, {\n                  size: 24,\n                  className: \"text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 546,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 537,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 528,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 465,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 394,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualBudtender, \"BTsnWV3Gng1Q/IQkgfbFHlqylv4=\");\n_c = VirtualBudtender;\nexport default VirtualBudtender;\nvar _c;\n$RefreshReg$(_c, \"VirtualBudtender\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Mic","VolumeX","Volume2","RefreshCw","axios","LoadingAnimation","Message","PreferenceModal","SpeechManager","jsxDEV","_jsxDEV","VOICE_OPTIONS","DEFAULT","RATE","PITCH","TIMING","THINKING","MESSAGE_DELAY","VirtualBudtender","_s","showPreferenceModal","setShowPreferenceModal","chatHistory","setChatHistory","isLoading","setIsLoading","isRecording","setIsRecording","currentSpeech","setCurrentSpeech","textInput","setTextInput","inputMode","setInputMode","playingAudioId","setPlayingAudioId","isMuted","setIsMuted","isSpeechSupported","setIsSpeechSupported","isPlaying","setIsPlaying","userId","Date","now","Math","random","toString","substr","chatEndRef","recognition","lastProcessedMessage","speechManagerRef","current","setStateChangeCallback","playing","stop","error","console","isSupported","window","_chatEndRef$current","scrollIntoView","behavior","handleSubmit","msg","trim","userMessageId","prev","type","content","replace","id","loadingId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isThinking","conversationHistoryForAPI","filter","message","map","role","response","post","conversationHistory","greeting","products","followUpQuestion","recommendations","data","formattedContent","length","forEach","product","name","size","thc","cbd","withoutThinking","m","responseMessage","slice","setTimeout","speakResponse","handleProductSelect","formattedDetails","Name","equivalentTo","thcMin","thcMax","cbdMin","cbdMax","description","inventory","handleProductFeedback","productId","isLike","feedback","rec","CatalogItemId","userFeedback","text","_recognition$current","speak","togglePlayback","pause","resume","initializeSpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","result","join","onend","onerror","toggleRecording","start","handlePreferenceSelect","preference","initialMessage","showCategories","handleTextSubmit","e","preventDefault","resetConversation","onSelect","src","alt","onClick","isUser","onPlayback","onProductSelect","onLike","onDislike","onCategorySelect","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\n\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  // State declarations\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  // Refs\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n  // Initialize speech manager\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback((playing) => {\n        setIsPlaying(playing);\n      });\n\n      return () => {\n        if (speechManagerRef.current) {\n          speechManagerRef.current.stop();\n        }\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  // Initialize speech recognition support check\n  useEffect(() => {\n    const isSupported = 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;\n    setIsSpeechSupported(isSupported);\n  }, []);\n\n  // Auto-scroll to latest message\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [chatHistory]);\n\n  // Message handling functions\n  const handleSubmit = useCallback(async (msg) => {\n    if (msg.trim() === '' || msg === lastProcessedMessage.current) return;\n\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n    \n    // Add user message\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, { \n      type: 'user', \n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId \n    }]);\n\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: (\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"animate-pulse\">VirtualBudtender is thinking</span>\n          <LoadingAnimation />\n        </div>\n      ),\n      id: loadingId,\n      isThinking: true\n    }]);\n\n    setIsLoading(true);\n\n    try {\n      const conversationHistoryForAPI = chatHistory\n        .filter(message => !message.isThinking)\n        .map(message => ({\n          role: message.type === 'user' ? 'user' : 'assistant',\n          content: typeof message.content === 'string' ? message.content : 'Loading...'\n        }));\n\n      const response = await axios.post('http://localhost:5001/api/chat', { \n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n\n      const { greeting, products, followUpQuestion, recommendations } = response.data;\n      \n      // Format the response content\n      let formattedContent = greeting || '';\n      \n      if (products?.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      \n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      // Remove thinking message and add response\n      setChatHistory(prev => {\n  const withoutThinking = prev.filter(m => m.id !== loadingId);\n\n  const responseMessage = {\n    type: 'budtender',\n    content: formattedContent.trim(),\n    id: Date.now(),\n    recommendations: recommendations.slice(0, 5) // ðŸ”¥ Limit initial view to 5\n  };\n\n  // Optional: trigger voice output\n  if (inputMode === 'voice' && !isMuted) {\n    setTimeout(() => {\n      speakResponse(formattedContent.trim(), responseMessage.id);\n    }, TIMING.MESSAGE_DELAY);\n  }\n\n  return [...withoutThinking, responseMessage];\n});\n\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: \"I apologize, but I encountered a technical issue. Could you please try your request again?\",\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async (product) => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      \n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    \n    setPlayingAudioId(id);\n    \n    if (isRecording) {\n      recognition.current?.stop();\n      setIsRecording(false);\n    }\n\n    speechManagerRef.current.speak(\n      text,\n      () => setPlayingAudioId(id),\n      () => setPlayingAudioId(null),\n      () => {\n        console.error('Error speaking response');\n        setPlayingAudioId(null);\n      }\n    );\n  }, [isMuted, isRecording]);\n\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n\n    recognition.current.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0].transcript)\n        .join('');\n      setCurrentSpeech(transcript);\n    };\n\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n\n    recognition.current.onerror = (event) => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback((preference) => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    \n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n\n    setChatHistory([initialMessage]);\n    \n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n\n  const handleTextSubmit = (e) => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    \n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    \n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    \n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return (\n    <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\n      {showPreferenceModal && <PreferenceModal onSelect={handlePreferenceSelect} />}\n      \n      {/* Split Header */}\n      <div className=\"flex w-full\">\n        {/* Black section for centered logo */}\n        <div className=\"w-1/3 bg-black py-4 flex items-center justify-center\">\n          <div>\n            <img \n              src=\"/Runway-Pot-Cannabis.png\" \n              alt=\"Runway Pot Cannabis Logo\" \n              className=\"h-16 w-auto\"\n            />\n          </div>\n        </div>\n\n        {/* Yellow section for controls */}\n        <div className=\"w-2/3 bg-[#f0b442]\">\n          <div className=\"flex flex-col\">\n            {/* Title and Controls */}\n            <div className=\"p-6 flex justify-between items-center\">\n              <div>\n                <div className=\"text-black font-semibold text-sm\">RUNWAY POTPILOT</div>\n                <h2 className=\"text-2xl font-bold text-black\">How can I assist you today?</h2>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Text\n                </button>\n                <button\n                  onClick={() => setInputMode('voice')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Voice\n                </button>\n                <button\n                  onClick={resetConversation}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  <RefreshCw size={20} />\n                </button>\n                <button\n                  onClick={() => {\n                    if (speechManagerRef.current) {\n                      speechManagerRef.current.stop();\n                    }\n                    setIsMuted(!isMuted);\n                  }}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\n                </button>\n              </div>\n            </div>\n            \n            {/* Divider Line */}\n            <div className=\"h-px bg-black/10\" />\n          </div>\n        </div>\n      </div>\n\n      {/* Main Container */}\n      <div className=\"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\">\n        {/* Image and Chat Container */}\n        <div className=\"w-full flex h-full\">\n          {/* Budtender Image Section */}\n          <div className=\"hidden md:block md:w-1/3 bg-black relative\">\n            <div className=\"h-full sticky top-0\">\n              <img \n                src=\"/Budtender.webp\" \n                alt=\"Virtual Budtender\" \n                className=\"w-full h-full object-cover\"\n              />\n              {isRecording && (\n                <div className=\"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\">\n                  <div className=\"animate-ping w-4 h-4 bg-red-600 rounded-full\"></div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Chat Section */}\n          <div className=\"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\">\n            {/* Messages - Scrollable */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n              <div className=\"p-6 space-y-4\">\n                {chatHistory.map((msg) => (\n                  <Message\n                    key={msg.id}\n                    message={msg}\n                    isUser={msg.type === 'user'}\n                    onPlayback={togglePlayback}\n                    isPlaying={isPlaying}\n                    playingAudioId={playingAudioId}\n                    isMuted={isMuted}\n                    recommendations={msg.recommendations}\n                    onProductSelect={handleProductSelect}\n                    onLike={(productId) => handleProductFeedback(productId, true)}\n                    onDislike={(productId) => handleProductFeedback(productId, false)}\n                    onCategorySelect={handleSubmit}\n                  />\n                ))}\n                <div ref={chatEndRef} />\n              </div>\n            </div>\n\n            {/* Input Section */}\n            <div className=\"border-t border-black/10 p-6 bg-[#fcaf17]\">\n              {inputMode === 'text' ? (\n                <form onSubmit={handleTextSubmit} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={textInput}\n                    onChange={(e) => setTextInput(e.target.value)}\n                    placeholder=\"Type your message here...\"\n                    className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\"\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"submit\"\n                    className=\"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    disabled={isLoading || !textInput.trim()}\n                  >\n                    Send\n                  </button>\n                </form>\n              ) : (\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\">\n                    {!isSpeechSupported ? (\n                      \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\"\n                    ) : (\n                      currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n                    )}\n                  </div>\n                  {isSpeechSupported && (\n                    <button\n                      onClick={toggleRecording}\n                      className={`w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${\n                        isRecording \n                          ? 'bg-red-500 animate-pulse' \n                          : 'bg-green-500 hover:bg-green-600'\n                      }`}\n                      disabled={isLoading}\n                    >\n                      <Mic size={24} className=\"text-white\" />\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualBudtender;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}