{"ast":null,"code":"var _jsxFileName = \"/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  _s();\n  // State declarations\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(playing => {\n        setIsPlaying(playing);\n      });\n      return () => {\n        if (speechManagerRef.current) {\n          speechManagerRef.current.stop();\n        }\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n  useEffect(() => {\n    const isSupported = 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;\n    setIsSpeechSupported(isSupported);\n  }, []);\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  }, [chatHistory]);\n  const handleSubmit = useCallback(async msg => {\n    // ðŸ”§ Fix: Support RECOMMENDATION_REQUEST payloads\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const {\n        filters\n      } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n      const {\n        greeting,\n        recommendations\n      } = response.data;\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting,\n        id: Date.now(),\n        recommendations: recommendations.slice(0, 5)\n      };\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"VirtualBudtender is thinking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingAnimation, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this),\n      id: loadingId,\n      isThinking: true\n    }]);\n    setIsLoading(true);\n    try {\n      var _products;\n      const conversationHistoryForAPI = chatHistory.filter(message => !message.isThinking).map(message => ({\n        role: message.type === 'user' ? 'user' : 'assistant',\n        content: typeof message.content === 'string' ? message.content : 'Loading...'\n      }));\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n      let {\n        greeting,\n        products,\n        followUpQuestion,\n        recommendations\n      } = response.data;\n\n      // ðŸ”§ Fix: use recommendations if products is missing\n      if ((!products || !products.length) && recommendations !== null && recommendations !== void 0 && recommendations.length) {\n        products = recommendations;\n      }\n      let formattedContent = greeting || '';\n      if ((_products = products) !== null && _products !== void 0 && _products.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: recommendations.slice(0, 5)\n        };\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => {\n            speakResponse(formattedContent.trim(), responseMessage.id);\n          }, TIMING.MESSAGE_DELAY);\n        }\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: \"I apologize, but I encountered a technical issue. Could you please try your request again?\",\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async product => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    setPlayingAudioId(id);\n    if (isRecording) {\n      var _recognition$current;\n      (_recognition$current = recognition.current) === null || _recognition$current === void 0 ? void 0 : _recognition$current.stop();\n      setIsRecording(false);\n    }\n    speechManagerRef.current.speak(text, () => setPlayingAudioId(id), () => setPlayingAudioId(null), () => {\n      console.error('Error speaking response');\n      setPlayingAudioId(null);\n    });\n  }, [isMuted, isRecording]);\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n    recognition.current.onresult = event => {\n      const transcript = Array.from(event.results).map(result => result[0].transcript).join('');\n      setCurrentSpeech(transcript);\n    };\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n    recognition.current.onerror = event => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback(preference => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n  const handleTextSubmit = e => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen bg-black flex flex-col overflow-hidden\",\n    children: [showPreferenceModal && /*#__PURE__*/_jsxDEV(PreferenceModal, {\n      onSelect: handlePreferenceSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 31\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/3 bg-black py-4 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/Runway-Pot-Cannabis.png\",\n            alt: \"Runway Pot Cannabis Logo\",\n            className: \"h-16 w-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-2/3 bg-[#f0b442]\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-black font-semibold text-sm\",\n                children: \"RUNWAY POTPILOT\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 435,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-black\",\n                children: \"How can I assist you today?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 434,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('text'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('voice'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Voice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: resetConversation,\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 459,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (speechManagerRef.current) {\n                    speechManagerRef.current.stop();\n                  }\n                  setIsMuted(!isMuted);\n                },\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 470,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 470,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 461,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-black/10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block md:w-1/3 bg-black relative\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full sticky top-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/Budtender.webp\",\n              alt: \"Virtual Budtender\",\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-ping w-4 h-4 bg-red-600 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 495,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-y-auto custom-scrollbar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6 space-y-4\",\n              children: [chatHistory.map(msg => /*#__PURE__*/_jsxDEV(Message, {\n                message: msg,\n                isUser: msg.type === 'user',\n                onPlayback: togglePlayback,\n                isPlaying: isPlaying,\n                playingAudioId: playingAudioId,\n                isMuted: isMuted,\n                recommendations: msg.recommendations,\n                onProductSelect: handleProductSelect,\n                onLike: productId => handleProductFeedback(productId, true),\n                onDislike: productId => handleProductFeedback(productId, false),\n                onCategorySelect: handleSubmit\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 507,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 522,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 505,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-black/10 p-6 bg-[#fcaf17]\",\n            children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleTextSubmit,\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: textInput,\n                onChange: e => setTextInput(e.target.value),\n                placeholder: \"Type your message here...\",\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 530,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",\n                disabled: isLoading || !textInput.trim(),\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 538,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                children: !isSpeechSupported ? \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\" : currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 548,\n                columnNumber: 19\n              }, this), isSpeechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRecording,\n                className: `w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${isRecording ? 'bg-red-500 animate-pulse' : 'bg-green-500 hover:bg-green-600'}`,\n                disabled: isLoading,\n                children: /*#__PURE__*/_jsxDEV(Mic, {\n                  size: 24,\n                  className: \"text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 565,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 556,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 502,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 413,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualBudtender, \"BTsnWV3Gng1Q/IQkgfbFHlqylv4=\");\n_c = VirtualBudtender;\nexport default VirtualBudtender;\nvar _c;\n$RefreshReg$(_c, \"VirtualBudtender\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Mic","VolumeX","Volume2","RefreshCw","axios","LoadingAnimation","Message","PreferenceModal","SpeechManager","jsxDEV","_jsxDEV","VOICE_OPTIONS","DEFAULT","RATE","PITCH","TIMING","THINKING","MESSAGE_DELAY","VirtualBudtender","_s","showPreferenceModal","setShowPreferenceModal","chatHistory","setChatHistory","isLoading","setIsLoading","isRecording","setIsRecording","currentSpeech","setCurrentSpeech","textInput","setTextInput","inputMode","setInputMode","playingAudioId","setPlayingAudioId","isMuted","setIsMuted","isSpeechSupported","setIsSpeechSupported","isPlaying","setIsPlaying","userId","Date","now","Math","random","toString","substr","chatEndRef","recognition","lastProcessedMessage","speechManagerRef","current","setStateChangeCallback","playing","stop","error","console","isSupported","window","_chatEndRef$current","scrollIntoView","behavior","handleSubmit","msg","type","filters","response","post","message","greeting","recommendations","data","responseMessage","content","id","slice","prev","trim","userMessageId","replace","loadingId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isThinking","_products","conversationHistoryForAPI","filter","map","role","conversationHistory","products","followUpQuestion","length","formattedContent","forEach","product","name","size","thc","cbd","withoutThinking","m","setTimeout","speakResponse","handleProductSelect","formattedDetails","Name","equivalentTo","thcMin","thcMax","cbdMin","cbdMax","description","inventory","handleProductFeedback","productId","isLike","feedback","rec","CatalogItemId","userFeedback","text","_recognition$current","speak","togglePlayback","pause","resume","initializeSpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","result","join","onend","onerror","toggleRecording","start","handlePreferenceSelect","preference","initialMessage","showCategories","handleTextSubmit","e","preventDefault","resetConversation","onSelect","src","alt","onClick","isUser","onPlayback","onProductSelect","onLike","onDislike","onCategorySelect","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\n\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  // State declarations\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback((playing) => {\n        setIsPlaying(playing);\n      });\n      return () => {\n        if (speechManagerRef.current) {\n          speechManagerRef.current.stop();\n        }\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    const isSupported = 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window;\n    setIsSpeechSupported(isSupported);\n  }, []);\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [chatHistory]);\n\n  const handleSubmit = useCallback(async (msg) => {\n    // ðŸ”§ Fix: Support RECOMMENDATION_REQUEST payloads\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const { filters } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n\n      const { greeting, recommendations } = response.data;\n\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting,\n        id: Date.now(),\n        recommendations: recommendations.slice(0, 5)\n      };\n\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: (\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"animate-pulse\">VirtualBudtender is thinking</span>\n          <LoadingAnimation />\n        </div>\n      ),\n      id: loadingId,\n      isThinking: true\n    }]);\n\n    setIsLoading(true);\n\n    try {\n      const conversationHistoryForAPI = chatHistory\n        .filter(message => !message.isThinking)\n        .map(message => ({\n          role: message.type === 'user' ? 'user' : 'assistant',\n          content: typeof message.content === 'string' ? message.content : 'Loading...'\n        }));\n\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n\n      let { greeting, products, followUpQuestion, recommendations } = response.data;\n\n      // ðŸ”§ Fix: use recommendations if products is missing\n      if ((!products || !products.length) && recommendations?.length) {\n        products = recommendations;\n      }\n\n\n      let formattedContent = greeting || '';\n\n      if (products?.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: recommendations.slice(0, 5)\n        };\n\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => {\n            speakResponse(formattedContent.trim(), responseMessage.id);\n          }, TIMING.MESSAGE_DELAY);\n        }\n\n        return [...withoutThinking, responseMessage];\n      });\n\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: \"I apologize, but I encountered a technical issue. Could you please try your request again?\",\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async (product) => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      \n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    \n    setPlayingAudioId(id);\n    \n    if (isRecording) {\n      recognition.current?.stop();\n      setIsRecording(false);\n    }\n\n    speechManagerRef.current.speak(\n      text,\n      () => setPlayingAudioId(id),\n      () => setPlayingAudioId(null),\n      () => {\n        console.error('Error speaking response');\n        setPlayingAudioId(null);\n      }\n    );\n  }, [isMuted, isRecording]);\n\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n\n    recognition.current.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0].transcript)\n        .join('');\n      setCurrentSpeech(transcript);\n    };\n\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n\n    recognition.current.onerror = (event) => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback((preference) => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    \n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n\n    setChatHistory([initialMessage]);\n    \n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n\n  const handleTextSubmit = (e) => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    \n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    \n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    \n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return (\n    <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\n      {showPreferenceModal && <PreferenceModal onSelect={handlePreferenceSelect} />}\n      \n      {/* Split Header */}\n      <div className=\"flex w-full\">\n        {/* Black section for centered logo */}\n        <div className=\"w-1/3 bg-black py-4 flex items-center justify-center\">\n          <div>\n            <img \n              src=\"/Runway-Pot-Cannabis.png\" \n              alt=\"Runway Pot Cannabis Logo\" \n              className=\"h-16 w-auto\"\n            />\n          </div>\n        </div>\n\n        {/* Yellow section for controls */}\n        <div className=\"w-2/3 bg-[#f0b442]\">\n          <div className=\"flex flex-col\">\n            {/* Title and Controls */}\n            <div className=\"p-6 flex justify-between items-center\">\n              <div>\n                <div className=\"text-black font-semibold text-sm\">RUNWAY POTPILOT</div>\n                <h2 className=\"text-2xl font-bold text-black\">How can I assist you today?</h2>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Text\n                </button>\n                <button\n                  onClick={() => setInputMode('voice')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Voice\n                </button>\n                <button\n                  onClick={resetConversation}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  <RefreshCw size={20} />\n                </button>\n                <button\n                  onClick={() => {\n                    if (speechManagerRef.current) {\n                      speechManagerRef.current.stop();\n                    }\n                    setIsMuted(!isMuted);\n                  }}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\n                </button>\n              </div>\n            </div>\n            \n            {/* Divider Line */}\n            <div className=\"h-px bg-black/10\" />\n          </div>\n        </div>\n      </div>\n\n      {/* Main Container */}\n      <div className=\"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\">\n        {/* Image and Chat Container */}\n        <div className=\"w-full flex h-full\">\n          {/* Budtender Image Section */}\n          <div className=\"hidden md:block md:w-1/3 bg-black relative\">\n            <div className=\"h-full sticky top-0\">\n              <img \n                src=\"/Budtender.webp\" \n                alt=\"Virtual Budtender\" \n                className=\"w-full h-full object-cover\"\n              />\n              {isRecording && (\n                <div className=\"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\">\n                  <div className=\"animate-ping w-4 h-4 bg-red-600 rounded-full\"></div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Chat Section */}\n          <div className=\"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\">\n            {/* Messages - Scrollable */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n              <div className=\"p-6 space-y-4\">\n                {chatHistory.map((msg) => (\n                  <Message\n                    key={msg.id}\n                    message={msg}\n                    isUser={msg.type === 'user'}\n                    onPlayback={togglePlayback}\n                    isPlaying={isPlaying}\n                    playingAudioId={playingAudioId}\n                    isMuted={isMuted}\n                    recommendations={msg.recommendations}\n                    onProductSelect={handleProductSelect}\n                    onLike={(productId) => handleProductFeedback(productId, true)}\n                    onDislike={(productId) => handleProductFeedback(productId, false)}\n                    onCategorySelect={handleSubmit}\n                  />\n                ))}\n                <div ref={chatEndRef} />\n              </div>\n            </div>\n\n            {/* Input Section */}\n            <div className=\"border-t border-black/10 p-6 bg-[#fcaf17]\">\n              {inputMode === 'text' ? (\n                <form onSubmit={handleTextSubmit} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={textInput}\n                    onChange={(e) => setTextInput(e.target.value)}\n                    placeholder=\"Type your message here...\"\n                    className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\"\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"submit\"\n                    className=\"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    disabled={isLoading || !textInput.trim()}\n                  >\n                    Send\n                  </button>\n                </form>\n              ) : (\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\">\n                    {!isSpeechSupported ? (\n                      \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\"\n                    ) : (\n                      currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n                    )}\n                  </div>\n                  {isSpeechSupported && (\n                    <button\n                      onClick={toggleRecording}\n                      className={`w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${\n                        isRecording \n                          ? 'bg-red-500 animate-pulse' \n                          : 'bg-green-500 hover:bg-green-600'\n                      }`}\n                      disabled={isLoading}\n                    >\n                      <Mic size={24} className=\"text-white\" />\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualBudtender;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}