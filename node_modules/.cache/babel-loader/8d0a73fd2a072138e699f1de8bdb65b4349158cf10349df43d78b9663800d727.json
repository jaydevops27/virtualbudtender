{"ast":null,"code":"var _jsxFileName = \"/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\nconst VirtualBudtender = () => {\n  _s();\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const lastUsedFiltersRef = useRef(null);\n  const speechManagerRef = useRef(null);\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => {\n        var _speechManagerRef$cur;\n        return (_speechManagerRef$cur = speechManagerRef.current) === null || _speechManagerRef$cur === void 0 ? void 0 : _speechManagerRef$cur.stop();\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [chatHistory]);\n  const handleSubmit = useCallback(async msg => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const {\n        filters\n      } = msg;\n      const mergedFilters = filters || lastUsedFiltersRef.current;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters: mergedFilters\n      });\n      const {\n        greeting,\n        recommendations\n      } = response.data;\n      const shownProductIds = new Set();\n      chatHistory.forEach(m => {\n        var _m$recommendations;\n        return (_m$recommendations = m.recommendations) === null || _m$recommendations === void 0 ? void 0 : _m$recommendations.forEach(r => shownProductIds.add(r.CatalogItemId));\n      });\n      const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting || 'Here are some more recommendations for you:',\n        id: Date.now(),\n        recommendations: newRecommendations.slice(0, 5),\n        filters: mergedFilters\n      };\n      if (newRecommendations.length === 0) {\n        responseMessage.content += '\\nWe\\'ve shown you all available matches. Would you like to explore other similar options like hybrid or indica edibles?';\n      }\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"VirtualBudtender is thinking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingAnimation, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this),\n      id: loadingId,\n      isThinking: true\n    }]);\n    setIsLoading(true);\n    try {\n      var _products;\n      const conversationHistoryForAPI = chatHistory.filter(message => !message.isThinking).map(message => ({\n        role: message.type === 'user' ? 'user' : 'assistant',\n        content: typeof message.content === 'string' ? message.content : 'Loading...'\n      }));\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n      let {\n        greeting,\n        products,\n        followUpQuestion,\n        recommendations,\n        filters\n      } = response.data;\n      if ((!products || !products.length) && recommendations !== null && recommendations !== void 0 && recommendations.length) {\n        products = recommendations;\n      }\n      if (filters) {\n        lastUsedFiltersRef.current = filters;\n      }\n      let formattedContent = greeting || '';\n      if ((_products = products) !== null && _products !== void 0 && _products.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const shownProductIds = new Set();\n        prev.forEach(m => {\n          var _m$recommendations2;\n          return (_m$recommendations2 = m.recommendations) === null || _m$recommendations2 === void 0 ? void 0 : _m$recommendations2.forEach(r => shownProductIds.add(r.CatalogItemId));\n        });\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5),\n          filters: filters || lastUsedFiltersRef.current\n        };\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async product => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    setPlayingAudioId(id);\n    if (isRecording) {\n      var _recognition$current;\n      (_recognition$current = recognition.current) === null || _recognition$current === void 0 ? void 0 : _recognition$current.stop();\n      setIsRecording(false);\n    }\n    speechManagerRef.current.speak(text, () => setPlayingAudioId(id), () => setPlayingAudioId(null), () => {\n      console.error('Error speaking response');\n      setPlayingAudioId(null);\n    });\n  }, [isMuted, isRecording]);\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n    recognition.current.onresult = event => {\n      const transcript = Array.from(event.results).map(result => result[0].transcript).join('');\n      setCurrentSpeech(transcript);\n    };\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n    recognition.current.onerror = event => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback(preference => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n  const handleTextSubmit = e => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen bg-black flex flex-col overflow-hidden\",\n    children: [showPreferenceModal && /*#__PURE__*/_jsxDEV(PreferenceModal, {\n      onSelect: handlePreferenceSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 31\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/3 bg-black py-4 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/Runway-Pot-Cannabis.png\",\n            alt: \"Runway Pot Cannabis Logo\",\n            className: \"h-16 w-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-2/3 bg-[#f0b442]\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-black font-semibold text-sm\",\n                children: \"RUNWAY POTPILOT\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 438,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-black\",\n                children: \"How can I assist you today?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 437,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('text'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('voice'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Voice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: resetConversation,\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 462,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (speechManagerRef.current) {\n                    speechManagerRef.current.stop();\n                  }\n                  setIsMuted(!isMuted);\n                },\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 473,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 473,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 464,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 441,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-black/10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block md:w-1/3 bg-black relative\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full sticky top-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/Budtender.webp\",\n              alt: \"Virtual Budtender\",\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-ping w-4 h-4 bg-red-600 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 498,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-y-auto custom-scrollbar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6 space-y-4\",\n              children: [chatHistory.map(msg => /*#__PURE__*/_jsxDEV(Message, {\n                message: msg,\n                isUser: msg.type === 'user',\n                onPlayback: togglePlayback,\n                isPlaying: isPlaying,\n                playingAudioId: playingAudioId,\n                isMuted: isMuted,\n                recommendations: msg.recommendations,\n                onProductSelect: handleProductSelect,\n                onLike: productId => handleProductFeedback(productId, true),\n                onDislike: productId => handleProductFeedback(productId, false),\n                onCategorySelect: handleSubmit\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 510,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 525,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-black/10 p-6 bg-[#fcaf17]\",\n            children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleTextSubmit,\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: textInput,\n                onChange: e => setTextInput(e.target.value),\n                placeholder: \"Type your message here...\",\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 533,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",\n                disabled: isLoading || !textInput.trim(),\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 541,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                children: !isSpeechSupported ? \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\" : currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 551,\n                columnNumber: 19\n              }, this), isSpeechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRecording,\n                className: `w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${isRecording ? 'bg-red-500 animate-pulse' : 'bg-green-500 hover:bg-green-600'}`,\n                disabled: isLoading,\n                children: /*#__PURE__*/_jsxDEV(Mic, {\n                  size: 24,\n                  className: \"text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 568,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 550,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 416,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualBudtender, \"Au+8U22pvPkWhWlZdI/KLFXHcXw=\");\n_c = VirtualBudtender;\nexport default VirtualBudtender;\nvar _c;\n$RefreshReg$(_c, \"VirtualBudtender\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Mic","VolumeX","Volume2","RefreshCw","axios","LoadingAnimation","Message","PreferenceModal","SpeechManager","jsxDEV","_jsxDEV","VOICE_OPTIONS","DEFAULT","RATE","PITCH","TIMING","THINKING","MESSAGE_DELAY","VirtualBudtender","_s","showPreferenceModal","setShowPreferenceModal","chatHistory","setChatHistory","isLoading","setIsLoading","isRecording","setIsRecording","currentSpeech","setCurrentSpeech","textInput","setTextInput","inputMode","setInputMode","playingAudioId","setPlayingAudioId","isMuted","setIsMuted","isSpeechSupported","setIsSpeechSupported","isPlaying","setIsPlaying","userId","Date","now","Math","random","toString","substr","chatEndRef","recognition","lastProcessedMessage","lastUsedFiltersRef","speechManagerRef","current","setStateChangeCallback","_speechManagerRef$cur","stop","error","console","window","_chatEndRef$current","scrollIntoView","behavior","handleSubmit","msg","type","filters","mergedFilters","response","post","message","greeting","recommendations","data","shownProductIds","Set","forEach","m","_m$recommendations","r","add","CatalogItemId","newRecommendations","filter","has","responseMessage","content","id","slice","length","prev","trim","userMessageId","replace","loadingId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isThinking","_products","conversationHistoryForAPI","map","role","conversationHistory","products","followUpQuestion","formattedContent","product","name","size","thc","cbd","withoutThinking","_m$recommendations2","setTimeout","speakResponse","handleProductSelect","formattedDetails","Name","equivalentTo","thcMin","thcMax","cbdMin","cbdMax","description","inventory","handleProductFeedback","productId","isLike","feedback","rec","userFeedback","text","_recognition$current","speak","togglePlayback","pause","resume","initializeSpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","result","join","onend","onerror","toggleRecording","start","handlePreferenceSelect","preference","initialMessage","showCategories","handleTextSubmit","e","preventDefault","resetConversation","onSelect","src","alt","onClick","isUser","onPlayback","onProductSelect","onLike","onDislike","onCategorySelect","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\n\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\nconst VirtualBudtender = () => {\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const lastUsedFiltersRef = useRef(null);\n  const speechManagerRef = useRef(null);\n\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => speechManagerRef.current?.stop();\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [chatHistory]);\n\n  const handleSubmit = useCallback(async (msg) => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const { filters } = msg;\n      const mergedFilters = filters || lastUsedFiltersRef.current;\n\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters: mergedFilters\n      });\n\n      const { greeting, recommendations } = response.data;\n      const shownProductIds = new Set();\n      chatHistory.forEach(m => m.recommendations?.forEach(r => shownProductIds.add(r.CatalogItemId)));\n\n      const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting || 'Here are some more recommendations for you:',\n        id: Date.now(),\n        recommendations: newRecommendations.slice(0, 5),\n        filters: mergedFilters\n      };\n\n      if (newRecommendations.length === 0) {\n        responseMessage.content += '\\nWe\\'ve shown you all available matches. Would you like to explore other similar options like hybrid or indica edibles?';\n      }\n\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: (\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"animate-pulse\">VirtualBudtender is thinking</span>\n          <LoadingAnimation />\n        </div>\n      ),\n      id: loadingId,\n      isThinking: true\n    }]);\n\n    setIsLoading(true);\n\n    try {\n      const conversationHistoryForAPI = chatHistory\n        .filter(message => !message.isThinking)\n        .map(message => ({\n          role: message.type === 'user' ? 'user' : 'assistant',\n          content: typeof message.content === 'string' ? message.content : 'Loading...'\n        }));\n\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n\n      let { greeting, products, followUpQuestion, recommendations, filters } = response.data;\n\n      if ((!products || !products.length) && recommendations?.length) {\n        products = recommendations;\n      }\n\n      if (filters) {\n        lastUsedFiltersRef.current = filters;\n      }\n\n      let formattedContent = greeting || '';\n\n      if (products?.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\nâ€¢ ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const shownProductIds = new Set();\n        prev.forEach(m => m.recommendations?.forEach(r => shownProductIds.add(r.CatalogItemId)));\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5),\n          filters: filters || lastUsedFiltersRef.current\n        };\n\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async (product) => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      \n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    \n    setPlayingAudioId(id);\n    \n    if (isRecording) {\n      recognition.current?.stop();\n      setIsRecording(false);\n    }\n\n    speechManagerRef.current.speak(\n      text,\n      () => setPlayingAudioId(id),\n      () => setPlayingAudioId(null),\n      () => {\n        console.error('Error speaking response');\n        setPlayingAudioId(null);\n      }\n    );\n  }, [isMuted, isRecording]);\n\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n\n    recognition.current.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0].transcript)\n        .join('');\n      setCurrentSpeech(transcript);\n    };\n\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n\n    recognition.current.onerror = (event) => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback((preference) => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    \n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n\n    setChatHistory([initialMessage]);\n    \n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n\n  const handleTextSubmit = (e) => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    \n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    \n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    \n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return (\n    <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\n      {showPreferenceModal && <PreferenceModal onSelect={handlePreferenceSelect} />}\n      \n      {/* Split Header */}\n      <div className=\"flex w-full\">\n        {/* Black section for centered logo */}\n        <div className=\"w-1/3 bg-black py-4 flex items-center justify-center\">\n          <div>\n            <img \n              src=\"/Runway-Pot-Cannabis.png\" \n              alt=\"Runway Pot Cannabis Logo\" \n              className=\"h-16 w-auto\"\n            />\n          </div>\n        </div>\n\n        {/* Yellow section for controls */}\n        <div className=\"w-2/3 bg-[#f0b442]\">\n          <div className=\"flex flex-col\">\n            {/* Title and Controls */}\n            <div className=\"p-6 flex justify-between items-center\">\n              <div>\n                <div className=\"text-black font-semibold text-sm\">RUNWAY POTPILOT</div>\n                <h2 className=\"text-2xl font-bold text-black\">How can I assist you today?</h2>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Text\n                </button>\n                <button\n                  onClick={() => setInputMode('voice')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Voice\n                </button>\n                <button\n                  onClick={resetConversation}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  <RefreshCw size={20} />\n                </button>\n                <button\n                  onClick={() => {\n                    if (speechManagerRef.current) {\n                      speechManagerRef.current.stop();\n                    }\n                    setIsMuted(!isMuted);\n                  }}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\n                </button>\n              </div>\n            </div>\n            \n            {/* Divider Line */}\n            <div className=\"h-px bg-black/10\" />\n          </div>\n        </div>\n      </div>\n\n      {/* Main Container */}\n      <div className=\"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\">\n        {/* Image and Chat Container */}\n        <div className=\"w-full flex h-full\">\n          {/* Budtender Image Section */}\n          <div className=\"hidden md:block md:w-1/3 bg-black relative\">\n            <div className=\"h-full sticky top-0\">\n              <img \n                src=\"/Budtender.webp\" \n                alt=\"Virtual Budtender\" \n                className=\"w-full h-full object-cover\"\n              />\n              {isRecording && (\n                <div className=\"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\">\n                  <div className=\"animate-ping w-4 h-4 bg-red-600 rounded-full\"></div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Chat Section */}\n          <div className=\"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\">\n            {/* Messages - Scrollable */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n              <div className=\"p-6 space-y-4\">\n                {chatHistory.map((msg) => (\n                  <Message\n                    key={msg.id}\n                    message={msg}\n                    isUser={msg.type === 'user'}\n                    onPlayback={togglePlayback}\n                    isPlaying={isPlaying}\n                    playingAudioId={playingAudioId}\n                    isMuted={isMuted}\n                    recommendations={msg.recommendations}\n                    onProductSelect={handleProductSelect}\n                    onLike={(productId) => handleProductFeedback(productId, true)}\n                    onDislike={(productId) => handleProductFeedback(productId, false)}\n                    onCategorySelect={handleSubmit}\n                  />\n                ))}\n                <div ref={chatEndRef} />\n              </div>\n            </div>\n\n            {/* Input Section */}\n            <div className=\"border-t border-black/10 p-6 bg-[#fcaf17]\">\n              {inputMode === 'text' ? (\n                <form onSubmit={handleTextSubmit} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={textInput}\n                    onChange={(e) => setTextInput(e.target.value)}\n                    placeholder=\"Type your message here...\"\n                    className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\"\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"submit\"\n                    className=\"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    disabled={isLoading || !textInput.trim()}\n                  >\n                    Send\n                  </button>\n                </form>\n              ) : (\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\">\n                    {!isSpeechSupported ? (\n                      \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\"\n                    ) : (\n                      currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n                    )}\n                  </div>\n                  {isSpeechSupported && (\n                    <button\n                      onClick={toggleRecording}\n                      className={`w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${\n                        isRecording \n                          ? 'bg-red-500 animate-pulse' \n                          : 'bg-green-500 hover:bg-green-600'\n                      }`}\n                      disabled={isLoading}\n                    >\n                      <Mic size={24} className=\"text-white\" />\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualBudtender;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}