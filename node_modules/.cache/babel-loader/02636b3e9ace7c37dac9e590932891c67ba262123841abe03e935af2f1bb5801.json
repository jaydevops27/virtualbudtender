{"ast":null,"code":"var _jsxFileName = \"/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  _s();\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => {\n        var _speechManagerRef$cur;\n        return (_speechManagerRef$cur = speechManagerRef.current) === null || _speechManagerRef$cur === void 0 ? void 0 : _speechManagerRef$cur.stop();\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [chatHistory]);\n  const handleSubmit = useCallback(async msg => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const {\n        filters\n      } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n      const {\n        greeting,\n        recommendations\n      } = response.data;\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting,\n        id: Date.now(),\n        recommendations: recommendations.slice(0, 5)\n      };\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"VirtualBudtender is thinking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingAnimation, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this),\n      id: loadingId,\n      isThinking: true\n    }]);\n    setIsLoading(true);\n    try {\n      var _products;\n      const conversationHistoryForAPI = chatHistory.filter(message => !message.isThinking).map(message => ({\n        role: message.type === 'user' ? 'user' : 'assistant',\n        content: typeof message.content === 'string' ? message.content : 'Loading...'\n      }));\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n      let {\n        greeting,\n        products,\n        followUpQuestion,\n        recommendations\n      } = response.data;\n      if ((!products || !products.length) && recommendations !== null && recommendations !== void 0 && recommendations.length) {\n        products = recommendations;\n      }\n      let formattedContent = greeting || '';\n      if ((_products = products) !== null && _products !== void 0 && _products.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\n• ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const shownProductIds = new Set();\n        prev.forEach(m => {\n          var _m$recommendations;\n          return (_m$recommendations = m.recommendations) === null || _m$recommendations === void 0 ? void 0 : _m$recommendations.forEach(r => shownProductIds.add(r.CatalogItemId));\n        });\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5)\n        };\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async product => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    setPlayingAudioId(id);\n    if (isRecording) {\n      var _recognition$current;\n      (_recognition$current = recognition.current) === null || _recognition$current === void 0 ? void 0 : _recognition$current.stop();\n      setIsRecording(false);\n    }\n    speechManagerRef.current.speak(text, () => setPlayingAudioId(id), () => setPlayingAudioId(null), () => {\n      console.error('Error speaking response');\n      setPlayingAudioId(null);\n    });\n  }, [isMuted, isRecording]);\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n    recognition.current.onresult = event => {\n      const transcript = Array.from(event.results).map(result => result[0].transcript).join('');\n      setCurrentSpeech(transcript);\n    };\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n    recognition.current.onerror = event => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback(preference => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n  const handleTextSubmit = e => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen bg-black flex flex-col overflow-hidden\",\n    children: [showPreferenceModal && /*#__PURE__*/_jsxDEV(PreferenceModal, {\n      onSelect: handlePreferenceSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 31\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/3 bg-black py-4 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/Runway-Pot-Cannabis.png\",\n            alt: \"Runway Pot Cannabis Logo\",\n            className: \"h-16 w-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-2/3 bg-[#f0b442]\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-black font-semibold text-sm\",\n                children: \"RUNWAY POTPILOT\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 427,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-black\",\n                children: \"How can I assist you today?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('text'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 431,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('voice'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Voice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: resetConversation,\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 451,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (speechManagerRef.current) {\n                    speechManagerRef.current.stop();\n                  }\n                  setIsMuted(!isMuted);\n                },\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 462,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 462,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-black/10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block md:w-1/3 bg-black relative\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full sticky top-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/Budtender.webp\",\n              alt: \"Virtual Budtender\",\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-ping w-4 h-4 bg-red-600 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 487,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-y-auto custom-scrollbar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6 space-y-4\",\n              children: [chatHistory.map(msg => /*#__PURE__*/_jsxDEV(Message, {\n                message: msg,\n                isUser: msg.type === 'user',\n                onPlayback: togglePlayback,\n                isPlaying: isPlaying,\n                playingAudioId: playingAudioId,\n                isMuted: isMuted,\n                recommendations: msg.recommendations,\n                onProductSelect: handleProductSelect,\n                onLike: productId => handleProductFeedback(productId, true),\n                onDislike: productId => handleProductFeedback(productId, false),\n                onCategorySelect: handleSubmit\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-black/10 p-6 bg-[#fcaf17]\",\n            children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleTextSubmit,\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: textInput,\n                onChange: e => setTextInput(e.target.value),\n                placeholder: \"Type your message here...\",\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 522,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",\n                disabled: isLoading || !textInput.trim(),\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 530,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                children: !isSpeechSupported ? \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\" : currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 540,\n                columnNumber: 19\n              }, this), isSpeechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRecording,\n                className: `w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${isRecording ? 'bg-red-500 animate-pulse' : 'bg-green-500 hover:bg-green-600'}`,\n                disabled: isLoading,\n                children: /*#__PURE__*/_jsxDEV(Mic, {\n                  size: 24,\n                  className: \"text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 557,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 548,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 539,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 405,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualBudtender, \"BTsnWV3Gng1Q/IQkgfbFHlqylv4=\");\n_c = VirtualBudtender;\nexport default VirtualBudtender;\nvar _c;\n$RefreshReg$(_c, \"VirtualBudtender\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Mic","VolumeX","Volume2","RefreshCw","axios","LoadingAnimation","Message","PreferenceModal","SpeechManager","jsxDEV","_jsxDEV","VOICE_OPTIONS","DEFAULT","RATE","PITCH","TIMING","THINKING","MESSAGE_DELAY","VirtualBudtender","_s","showPreferenceModal","setShowPreferenceModal","chatHistory","setChatHistory","isLoading","setIsLoading","isRecording","setIsRecording","currentSpeech","setCurrentSpeech","textInput","setTextInput","inputMode","setInputMode","playingAudioId","setPlayingAudioId","isMuted","setIsMuted","isSpeechSupported","setIsSpeechSupported","isPlaying","setIsPlaying","userId","Date","now","Math","random","toString","substr","chatEndRef","recognition","lastProcessedMessage","speechManagerRef","current","setStateChangeCallback","_speechManagerRef$cur","stop","error","console","window","_chatEndRef$current","scrollIntoView","behavior","handleSubmit","msg","type","filters","response","post","message","greeting","recommendations","data","responseMessage","content","id","slice","prev","trim","userMessageId","replace","loadingId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isThinking","_products","conversationHistoryForAPI","filter","map","role","conversationHistory","products","followUpQuestion","length","formattedContent","forEach","product","name","size","thc","cbd","withoutThinking","m","shownProductIds","Set","_m$recommendations","r","add","CatalogItemId","newRecommendations","has","setTimeout","speakResponse","handleProductSelect","formattedDetails","Name","equivalentTo","thcMin","thcMax","cbdMin","cbdMax","description","inventory","handleProductFeedback","productId","isLike","feedback","rec","userFeedback","text","_recognition$current","speak","togglePlayback","pause","resume","initializeSpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","result","join","onend","onerror","toggleRecording","start","handlePreferenceSelect","preference","initialMessage","showCategories","handleTextSubmit","e","preventDefault","resetConversation","onSelect","src","alt","onClick","isUser","onPlayback","onProductSelect","onLike","onDislike","onCategorySelect","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\n\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => speechManagerRef.current?.stop();\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [chatHistory]);\n\n  const handleSubmit = useCallback(async (msg) => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const { filters } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n\n      const { greeting, recommendations } = response.data;\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting,\n        id: Date.now(),\n        recommendations: recommendations.slice(0, 5)\n      };\n\n      setChatHistory(prev => [\n        ...prev,\n        responseMessage\n      ]);\n      return;\n    }\n\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: (\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"animate-pulse\">VirtualBudtender is thinking</span>\n          <LoadingAnimation />\n        </div>\n      ),\n      id: loadingId,\n      isThinking: true\n    }]);\n\n    setIsLoading(true);\n\n    try {\n      const conversationHistoryForAPI = chatHistory\n        .filter(message => !message.isThinking)\n        .map(message => ({\n          role: message.type === 'user' ? 'user' : 'assistant',\n          content: typeof message.content === 'string' ? message.content : 'Loading...'\n        }));\n\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n\n      let { greeting, products, followUpQuestion, recommendations } = response.data;\n      if ((!products || !products.length) && recommendations?.length) {\n        products = recommendations;\n      }\n\n      let formattedContent = greeting || '';\n\n      if (products?.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\n• ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n\n        const shownProductIds = new Set();\n        prev.forEach(m => m.recommendations?.forEach(r => shownProductIds.add(r.CatalogItemId)));\n\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5)\n        };\n\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async (product) => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      \n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    \n    setPlayingAudioId(id);\n    \n    if (isRecording) {\n      recognition.current?.stop();\n      setIsRecording(false);\n    }\n\n    speechManagerRef.current.speak(\n      text,\n      () => setPlayingAudioId(id),\n      () => setPlayingAudioId(null),\n      () => {\n        console.error('Error speaking response');\n        setPlayingAudioId(null);\n      }\n    );\n  }, [isMuted, isRecording]);\n\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n\n    recognition.current.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0].transcript)\n        .join('');\n      setCurrentSpeech(transcript);\n    };\n\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n\n    recognition.current.onerror = (event) => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback((preference) => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    \n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n\n    setChatHistory([initialMessage]);\n    \n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n\n  const handleTextSubmit = (e) => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    \n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    \n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    \n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return (\n    <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\n      {showPreferenceModal && <PreferenceModal onSelect={handlePreferenceSelect} />}\n      \n      {/* Split Header */}\n      <div className=\"flex w-full\">\n        {/* Black section for centered logo */}\n        <div className=\"w-1/3 bg-black py-4 flex items-center justify-center\">\n          <div>\n            <img \n              src=\"/Runway-Pot-Cannabis.png\" \n              alt=\"Runway Pot Cannabis Logo\" \n              className=\"h-16 w-auto\"\n            />\n          </div>\n        </div>\n\n        {/* Yellow section for controls */}\n        <div className=\"w-2/3 bg-[#f0b442]\">\n          <div className=\"flex flex-col\">\n            {/* Title and Controls */}\n            <div className=\"p-6 flex justify-between items-center\">\n              <div>\n                <div className=\"text-black font-semibold text-sm\">RUNWAY POTPILOT</div>\n                <h2 className=\"text-2xl font-bold text-black\">How can I assist you today?</h2>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Text\n                </button>\n                <button\n                  onClick={() => setInputMode('voice')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Voice\n                </button>\n                <button\n                  onClick={resetConversation}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  <RefreshCw size={20} />\n                </button>\n                <button\n                  onClick={() => {\n                    if (speechManagerRef.current) {\n                      speechManagerRef.current.stop();\n                    }\n                    setIsMuted(!isMuted);\n                  }}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\n                </button>\n              </div>\n            </div>\n            \n            {/* Divider Line */}\n            <div className=\"h-px bg-black/10\" />\n          </div>\n        </div>\n      </div>\n\n      {/* Main Container */}\n      <div className=\"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\">\n        {/* Image and Chat Container */}\n        <div className=\"w-full flex h-full\">\n          {/* Budtender Image Section */}\n          <div className=\"hidden md:block md:w-1/3 bg-black relative\">\n            <div className=\"h-full sticky top-0\">\n              <img \n                src=\"/Budtender.webp\" \n                alt=\"Virtual Budtender\" \n                className=\"w-full h-full object-cover\"\n              />\n              {isRecording && (\n                <div className=\"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\">\n                  <div className=\"animate-ping w-4 h-4 bg-red-600 rounded-full\"></div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Chat Section */}\n          <div className=\"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\">\n            {/* Messages - Scrollable */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n              <div className=\"p-6 space-y-4\">\n                {chatHistory.map((msg) => (\n                  <Message\n                    key={msg.id}\n                    message={msg}\n                    isUser={msg.type === 'user'}\n                    onPlayback={togglePlayback}\n                    isPlaying={isPlaying}\n                    playingAudioId={playingAudioId}\n                    isMuted={isMuted}\n                    recommendations={msg.recommendations}\n                    onProductSelect={handleProductSelect}\n                    onLike={(productId) => handleProductFeedback(productId, true)}\n                    onDislike={(productId) => handleProductFeedback(productId, false)}\n                    onCategorySelect={handleSubmit}\n                  />\n                ))}\n                <div ref={chatEndRef} />\n              </div>\n            </div>\n\n            {/* Input Section */}\n            <div className=\"border-t border-black/10 p-6 bg-[#fcaf17]\">\n              {inputMode === 'text' ? (\n                <form onSubmit={handleTextSubmit} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={textInput}\n                    onChange={(e) => setTextInput(e.target.value)}\n                    placeholder=\"Type your message here...\"\n                    className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\"\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"submit\"\n                    className=\"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    disabled={isLoading || !textInput.trim()}\n                  >\n                    Send\n                  </button>\n                </form>\n              ) : (\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\">\n                    {!isSpeechSupported ? (\n                      \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\"\n                    ) : (\n                      currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n                    )}\n                  </div>\n                  {isSpeechSupported && (\n                    <button\n                      onClick={toggleRecording}\n                      className={`w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${\n                        isRecording \n                          ? 'bg-red-500 animate-pulse' \n                          : 'bg-green-500 hover:bg-green-600'\n                      }`}\n                      disabled={isLoading}\n                    >\n                      <Mic size={24} className=\"text-white\" />\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualBudtender;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}