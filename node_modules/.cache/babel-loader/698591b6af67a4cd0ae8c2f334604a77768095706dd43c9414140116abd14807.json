{"ast":null,"code":"var _jsxFileName = \"/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  _s();\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => {\n        var _speechManagerRef$cur;\n        return (_speechManagerRef$cur = speechManagerRef.current) === null || _speechManagerRef$cur === void 0 ? void 0 : _speechManagerRef$cur.stop();\n      };\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n  useEffect(() => {\n    var _chatEndRef$current;\n    (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [chatHistory]);\n  const handleSubmit = useCallback(async msg => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const {\n        filters\n      } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n      const {\n        greeting,\n        recommendations\n      } = response.data;\n      const shownProductIds = new Set();\n      chatHistory.forEach(m => {\n        var _m$recommendations;\n        return (_m$recommendations = m.recommendations) === null || _m$recommendations === void 0 ? void 0 : _m$recommendations.forEach(r => shownProductIds.add(r.CatalogItemId));\n      });\n      const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting || 'Here are some more recommendations for you:',\n        id: Date.now(),\n        recommendations: newRecommendations.slice(0, 5)\n      };\n      setChatHistory(prev => [...prev, responseMessage]);\n      return;\n    }\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-pulse\",\n          children: \"VirtualBudtender is thinking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(LoadingAnimation, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this),\n      id: loadingId,\n      isThinking: true\n    }]);\n    setIsLoading(true);\n    try {\n      var _products;\n      const conversationHistoryForAPI = chatHistory.filter(message => !message.isThinking).map(message => ({\n        role: message.type === 'user' ? 'user' : 'assistant',\n        content: typeof message.content === 'string' ? message.content : 'Loading...'\n      }));\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n      let {\n        greeting,\n        products,\n        followUpQuestion,\n        recommendations\n      } = response.data;\n      if ((!products || !products.length) && recommendations !== null && recommendations !== void 0 && recommendations.length) {\n        products = recommendations;\n      }\n      let formattedContent = greeting || '';\n      if ((_products = products) !== null && _products !== void 0 && _products.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\n• ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        const shownProductIds = new Set();\n        prev.forEach(m => {\n          var _m$recommendations2;\n          return (_m$recommendations2 = m.recommendations) === null || _m$recommendations2 === void 0 ? void 0 : _m$recommendations2.forEach(r => shownProductIds.add(r.CatalogItemId));\n        });\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5)\n        };\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async product => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    setPlayingAudioId(id);\n    if (isRecording) {\n      var _recognition$current;\n      (_recognition$current = recognition.current) === null || _recognition$current === void 0 ? void 0 : _recognition$current.stop();\n      setIsRecording(false);\n    }\n    speechManagerRef.current.speak(text, () => setPlayingAudioId(id), () => setPlayingAudioId(null), () => {\n      console.error('Error speaking response');\n      setPlayingAudioId(null);\n    });\n  }, [isMuted, isRecording]);\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n    recognition.current.onresult = event => {\n      const transcript = Array.from(event.results).map(result => result[0].transcript).join('');\n      setCurrentSpeech(transcript);\n    };\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n    recognition.current.onerror = event => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback(preference => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n  const handleTextSubmit = e => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen bg-black flex flex-col overflow-hidden\",\n    children: [showPreferenceModal && /*#__PURE__*/_jsxDEV(PreferenceModal, {\n      onSelect: handlePreferenceSelect\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 31\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/3 bg-black py-4 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/Runway-Pot-Cannabis.png\",\n            alt: \"Runway Pot Cannabis Logo\",\n            className: \"h-16 w-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-2/3 bg-[#f0b442]\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-6 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-black font-semibold text-sm\",\n                children: \"RUNWAY POTPILOT\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 432,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-2xl font-bold text-black\",\n                children: \"How can I assist you today?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 433,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 431,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('text'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Text\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setInputMode('voice'),\n                className: `px-4 py-2 rounded-lg transition duration-300 ${inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'}`,\n                children: \"Voice\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: resetConversation,\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 456,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  if (speechManagerRef.current) {\n                    speechManagerRef.current.stop();\n                  }\n                  setIsMuted(!isMuted);\n                },\n                className: \"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\",\n                children: isMuted ? /*#__PURE__*/_jsxDEV(VolumeX, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 467,\n                  columnNumber: 30\n                }, this) : /*#__PURE__*/_jsxDEV(Volume2, {\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 467,\n                  columnNumber: 54\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 458,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-px bg-black/10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hidden md:block md:w-1/3 bg-black relative\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-full sticky top-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"/Budtender.webp\",\n              alt: \"Virtual Budtender\",\n              className: \"w-full h-full object-cover\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 485,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-ping w-4 h-4 bg-red-600 rounded-full\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 overflow-y-auto custom-scrollbar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6 space-y-4\",\n              children: [chatHistory.map(msg => /*#__PURE__*/_jsxDEV(Message, {\n                message: msg,\n                isUser: msg.type === 'user',\n                onPlayback: togglePlayback,\n                isPlaying: isPlaying,\n                playingAudioId: playingAudioId,\n                isMuted: isMuted,\n                recommendations: msg.recommendations,\n                onProductSelect: handleProductSelect,\n                onLike: productId => handleProductFeedback(productId, true),\n                onDislike: productId => handleProductFeedback(productId, false),\n                onCategorySelect: handleSubmit\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: chatEndRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 519,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 501,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-black/10 p-6 bg-[#fcaf17]\",\n            children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleTextSubmit,\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: textInput,\n                onChange: e => setTextInput(e.target.value),\n                placeholder: \"Type your message here...\",\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                disabled: isLoading\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 527,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\",\n                disabled: isLoading || !textInput.trim(),\n                children: \"Send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 535,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\",\n                children: !isSpeechSupported ? \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\" : currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 545,\n                columnNumber: 19\n              }, this), isSpeechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: toggleRecording,\n                className: `w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${isRecording ? 'bg-red-500 animate-pulse' : 'bg-green-500 hover:bg-green-600'}`,\n                disabled: isLoading,\n                children: /*#__PURE__*/_jsxDEV(Mic, {\n                  size: 24,\n                  className: \"text-white\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 562,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 553,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 410,\n    columnNumber: 5\n  }, this);\n};\n_s(VirtualBudtender, \"BTsnWV3Gng1Q/IQkgfbFHlqylv4=\");\n_c = VirtualBudtender;\nexport default VirtualBudtender;\nvar _c;\n$RefreshReg$(_c, \"VirtualBudtender\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","Mic","VolumeX","Volume2","RefreshCw","axios","LoadingAnimation","Message","PreferenceModal","SpeechManager","jsxDEV","_jsxDEV","VOICE_OPTIONS","DEFAULT","RATE","PITCH","TIMING","THINKING","MESSAGE_DELAY","VirtualBudtender","_s","showPreferenceModal","setShowPreferenceModal","chatHistory","setChatHistory","isLoading","setIsLoading","isRecording","setIsRecording","currentSpeech","setCurrentSpeech","textInput","setTextInput","inputMode","setInputMode","playingAudioId","setPlayingAudioId","isMuted","setIsMuted","isSpeechSupported","setIsSpeechSupported","isPlaying","setIsPlaying","userId","Date","now","Math","random","toString","substr","chatEndRef","recognition","lastProcessedMessage","speechManagerRef","current","setStateChangeCallback","_speechManagerRef$cur","stop","error","console","window","_chatEndRef$current","scrollIntoView","behavior","handleSubmit","msg","type","filters","response","post","message","greeting","recommendations","data","shownProductIds","Set","forEach","m","_m$recommendations","r","add","CatalogItemId","newRecommendations","filter","has","responseMessage","content","id","slice","prev","trim","userMessageId","replace","loadingId","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isThinking","_products","conversationHistoryForAPI","map","role","conversationHistory","products","followUpQuestion","length","formattedContent","product","name","size","thc","cbd","withoutThinking","_m$recommendations2","setTimeout","speakResponse","handleProductSelect","formattedDetails","Name","equivalentTo","thcMin","thcMax","cbdMin","cbdMax","description","inventory","handleProductFeedback","productId","isLike","feedback","rec","userFeedback","text","_recognition$current","speak","togglePlayback","pause","resume","initializeSpeechRecognition","webkitSpeechRecognition","continuous","interimResults","lang","onresult","event","transcript","Array","from","results","result","join","onend","onerror","toggleRecording","start","handlePreferenceSelect","preference","initialMessage","showCategories","handleTextSubmit","e","preventDefault","resetConversation","onSelect","src","alt","onClick","isUser","onPlayback","onProductSelect","onLike","onDislike","onCategorySelect","ref","onSubmit","value","onChange","target","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/jaypatel/Desktop/with AWS voice/May-original/virtualbudtender/src/VirtualBudtender.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Mic, VolumeX, Volume2, RefreshCw } from 'lucide-react';\nimport axios from 'axios';\n\n// Local imports\nimport LoadingAnimation from './components/LoadingAnimation';\nimport Message from './components/Message';\nimport PreferenceModal from './components/PreferenceModal';\nimport SpeechManager from './utils/SpeechManager';\nimport './VirtualBudtender.css';\n\n// Constants\nconst VOICE_OPTIONS = {\n  DEFAULT: 'en-US',\n  RATE: 1,\n  PITCH: 1\n};\n\nconst TIMING = {\n  THINKING: 1500,\n  MESSAGE_DELAY: 500\n};\n\n// Main Component\nconst VirtualBudtender = () => {\n  const [showPreferenceModal, setShowPreferenceModal] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentSpeech, setCurrentSpeech] = useState('');\n  const [textInput, setTextInput] = useState('');\n  const [inputMode, setInputMode] = useState('text');\n  const [playingAudioId, setPlayingAudioId] = useState(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeechSupported, setIsSpeechSupported] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [userId] = useState(() => `user-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`);\n\n  const chatEndRef = useRef(null);\n  const recognition = useRef(null);\n  const lastProcessedMessage = useRef('');\n  const speechManagerRef = useRef(null);\n\n  useEffect(() => {\n    try {\n      speechManagerRef.current = new SpeechManager();\n      speechManagerRef.current.setStateChangeCallback(setIsPlaying);\n      return () => speechManagerRef.current?.stop();\n    } catch (error) {\n      console.error('Error initializing SpeechManager:', error);\n    }\n  }, []);\n\n  useEffect(() => {\n    setIsSpeechSupported('webkitSpeechRecognition' in window || 'SpeechRecognition' in window);\n  }, []);\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [chatHistory]);\n\n  const handleSubmit = useCallback(async (msg) => {\n    if (typeof msg === 'object' && msg.type === 'RECOMMENDATION_REQUEST') {\n      const { filters } = msg;\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: 'see more recommendations',\n        userId,\n        filters\n      });\n\n      const { greeting, recommendations } = response.data;\n      const shownProductIds = new Set();\n      chatHistory.forEach(m => m.recommendations?.forEach(r => shownProductIds.add(r.CatalogItemId)));\n\n      const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n\n      const responseMessage = {\n        type: 'budtender',\n        content: greeting || 'Here are some more recommendations for you:',\n        id: Date.now(),\n        recommendations: newRecommendations.slice(0, 5)\n      };\n\n      setChatHistory(prev => [\n        ...prev,\n        responseMessage\n      ]);\n      return;\n    }\n\n    if (typeof msg !== 'string' || msg.trim() === '' || msg === lastProcessedMessage.current) return;\n\n    lastProcessedMessage.current = msg;\n    setTextInput('');\n    setCurrentSpeech('');\n\n    const userMessageId = Date.now();\n    setChatHistory(prev => [...prev, {\n      type: 'user',\n      content: msg.replace(/\\n/g, ' ').trim(),\n      id: userMessageId\n    }]);\n\n    const loadingId = Date.now() + 1;\n    setChatHistory(prev => [...prev, {\n      type: 'budtender',\n      content: (\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"animate-pulse\">VirtualBudtender is thinking</span>\n          <LoadingAnimation />\n        </div>\n      ),\n      id: loadingId,\n      isThinking: true\n    }]);\n\n    setIsLoading(true);\n\n    try {\n      const conversationHistoryForAPI = chatHistory\n        .filter(message => !message.isThinking)\n        .map(message => ({\n          role: message.type === 'user' ? 'user' : 'assistant',\n          content: typeof message.content === 'string' ? message.content : 'Loading...'\n        }));\n\n      const response = await axios.post('http://localhost:5001/api/chat', {\n        message: msg,\n        conversationHistory: conversationHistoryForAPI,\n        userId\n      });\n\n      let { greeting, products, followUpQuestion, recommendations } = response.data;\n      if ((!products || !products.length) && recommendations?.length) {\n        products = recommendations;\n      }\n\n      let formattedContent = greeting || '';\n\n      if (products?.length) {\n        formattedContent += '\\n\\nProducts:';\n        products.forEach(product => {\n          formattedContent += `\\n• ${product.name}`;\n          formattedContent += `\\n  Size: ${product.size}`;\n          formattedContent += `\\n  THC: ${product.thc}`;\n          if (product.cbd !== 'N/A') {\n            formattedContent += `\\n  CBD: ${product.cbd}`;\n          }\n          formattedContent += '\\n';\n        });\n      }\n\n      if (followUpQuestion) {\n        formattedContent += `\\n${followUpQuestion}`;\n      }\n\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n\n        const shownProductIds = new Set();\n        prev.forEach(m => m.recommendations?.forEach(r => shownProductIds.add(r.CatalogItemId)));\n\n        const newRecommendations = recommendations.filter(r => !shownProductIds.has(r.CatalogItemId));\n\n        const responseMessage = {\n          type: 'budtender',\n          content: formattedContent.trim(),\n          id: Date.now(),\n          recommendations: newRecommendations.slice(0, 5)\n        };\n\n        if (inputMode === 'voice' && !isMuted) {\n          setTimeout(() => speakResponse(formattedContent.trim(), responseMessage.id), TIMING.MESSAGE_DELAY);\n        }\n\n        return [...withoutThinking, responseMessage];\n      });\n    } catch (error) {\n      console.error('Error in chat request:', error);\n      setChatHistory(prev => {\n        const withoutThinking = prev.filter(m => m.id !== loadingId);\n        return [...withoutThinking, {\n          type: 'budtender',\n          content: 'I apologize, but I encountered a technical issue. Could you please try your request again?',\n          id: Date.now()\n        }];\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [chatHistory, inputMode, isMuted, userId]);\n  // Product handling functions\n  const handleProductSelect = useCallback(async (product) => {\n    try {\n      const formattedDetails = `\n${product.Name}\nSize: ${product.equivalentTo}\nTHC: ${product.thcMin}-${product.thcMax}%\n${product.cbdMin ? `CBD: ${product.cbdMin}-${product.cbdMax}%\\n` : ''}\n${product.description || 'No description available.'}\n\nInventory: ${product.inventory} units\n      `.trim();\n      \n      setChatHistory(prev => [...prev, {\n        type: 'budtender',\n        content: formattedDetails,\n        id: Date.now(),\n        product: product\n      }]);\n\n      if (inputMode === 'voice' && !isMuted) {\n        speakResponse(formattedDetails, Date.now());\n      }\n    } catch (error) {\n      console.error('Error fetching product details:', error);\n    }\n  }, [inputMode, isMuted]);\n\n  // Product feedback handling\n  const handleProductFeedback = async (productId, isLike) => {\n    try {\n      await axios.post('http://localhost:5001/api/product-feedback', {\n        userId,\n        productId,\n        feedback: isLike ? 'like' : 'dislike'\n      });\n\n      setChatHistory(prev => prev.map(msg => {\n        if (msg.recommendations) {\n          return {\n            ...msg,\n            recommendations: msg.recommendations.map(rec => {\n              if (rec.CatalogItemId === productId) {\n                return {\n                  ...rec,\n                  userFeedback: isLike ? 'like' : 'dislike'\n                };\n              }\n              return rec;\n            })\n          };\n        }\n        return msg;\n      }));\n    } catch (error) {\n      console.error('Error sending product feedback:', error);\n    }\n  };\n\n  // Speech handling functions\n  const speakResponse = useCallback((text, id) => {\n    if (isMuted || !speechManagerRef.current) return;\n    \n    setPlayingAudioId(id);\n    \n    if (isRecording) {\n      recognition.current?.stop();\n      setIsRecording(false);\n    }\n\n    speechManagerRef.current.speak(\n      text,\n      () => setPlayingAudioId(id),\n      () => setPlayingAudioId(null),\n      () => {\n        console.error('Error speaking response');\n        setPlayingAudioId(null);\n      }\n    );\n  }, [isMuted, isRecording]);\n\n  const togglePlayback = useCallback((text, id) => {\n    if (!speechManagerRef.current) return;\n\n    if (playingAudioId === id && isPlaying) {\n      speechManagerRef.current.pause();\n    } else if (playingAudioId === id && !isPlaying) {\n      speechManagerRef.current.resume();\n    } else {\n      if (playingAudioId) {\n        speechManagerRef.current.stop();\n      }\n      speakResponse(text, id);\n    }\n  }, [playingAudioId, isPlaying, speakResponse]);\n\n  // Speech recognition functions\n  const initializeSpeechRecognition = useCallback(() => {\n    if (!('webkitSpeechRecognition' in window)) {\n      console.error('Speech recognition not supported');\n      setIsSpeechSupported(false);\n      return;\n    }\n\n    recognition.current = new window.webkitSpeechRecognition();\n    recognition.current.continuous = true;\n    recognition.current.interimResults = true;\n    recognition.current.lang = VOICE_OPTIONS.DEFAULT;\n\n    recognition.current.onresult = (event) => {\n      const transcript = Array.from(event.results)\n        .map(result => result[0].transcript)\n        .join('');\n      setCurrentSpeech(transcript);\n    };\n\n    recognition.current.onend = () => {\n      setIsRecording(false);\n    };\n\n    recognition.current.onerror = (event) => {\n      console.error('Speech recognition error:', event.error);\n      setIsRecording(false);\n    };\n  }, []);\n\n  const toggleRecording = useCallback(() => {\n    if (!recognition.current) {\n      initializeSpeechRecognition();\n    }\n\n    if (!recognition.current) {\n      console.error('Speech recognition is not supported in this browser');\n      return;\n    }\n\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n\n    try {\n      if (isRecording) {\n        recognition.current.stop();\n        if (currentSpeech.trim()) {\n          handleSubmit(currentSpeech);\n          setCurrentSpeech('');\n        }\n      } else {\n        setCurrentSpeech('');\n        recognition.current.start();\n      }\n      setIsRecording(!isRecording);\n    } catch (error) {\n      console.error('Speech recognition error:', error);\n      setIsRecording(false);\n      setCurrentSpeech('');\n    }\n  }, [isRecording, currentSpeech, handleSubmit, initializeSpeechRecognition]);\n\n  // UI Event Handlers\n  const handlePreferenceSelect = useCallback((preference) => {\n    setInputMode(preference);\n    setShowPreferenceModal(false);\n    \n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n\n    setChatHistory([initialMessage]);\n    \n    if (preference === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [isMuted, speakResponse]);\n\n  const handleTextSubmit = (e) => {\n    e.preventDefault();\n    if (textInput.trim() && !isLoading) {\n      handleSubmit(textInput);\n    }\n  };\n\n  const resetConversation = useCallback(() => {\n    if (speechManagerRef.current) {\n      speechManagerRef.current.stop();\n    }\n    \n    if (recognition.current && isRecording) {\n      recognition.current.stop();\n    }\n\n    const initialMessage = {\n      type: 'budtender',\n      content: \"Welcome to Runway Pot! I'm your Virtual Budtender. What type of product are you interested in today?\",\n      id: Date.now(),\n      showCategories: true\n    };\n    \n    setChatHistory([initialMessage]);\n    setCurrentSpeech('');\n    setTextInput('');\n    setIsLoading(false);\n    setIsRecording(false);\n    setPlayingAudioId(null);\n    \n    if (inputMode === 'voice' && !isMuted) {\n      setTimeout(() => {\n        speakResponse(initialMessage.content, initialMessage.id);\n      }, TIMING.MESSAGE_DELAY);\n    }\n  }, [inputMode, isMuted, isRecording, speakResponse]);\n  // Render Component\n  return (\n    <div className=\"h-screen bg-black flex flex-col overflow-hidden\">\n      {showPreferenceModal && <PreferenceModal onSelect={handlePreferenceSelect} />}\n      \n      {/* Split Header */}\n      <div className=\"flex w-full\">\n        {/* Black section for centered logo */}\n        <div className=\"w-1/3 bg-black py-4 flex items-center justify-center\">\n          <div>\n            <img \n              src=\"/Runway-Pot-Cannabis.png\" \n              alt=\"Runway Pot Cannabis Logo\" \n              className=\"h-16 w-auto\"\n            />\n          </div>\n        </div>\n\n        {/* Yellow section for controls */}\n        <div className=\"w-2/3 bg-[#f0b442]\">\n          <div className=\"flex flex-col\">\n            {/* Title and Controls */}\n            <div className=\"p-6 flex justify-between items-center\">\n              <div>\n                <div className=\"text-black font-semibold text-sm\">RUNWAY POTPILOT</div>\n                <h2 className=\"text-2xl font-bold text-black\">How can I assist you today?</h2>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'text' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Text\n                </button>\n                <button\n                  onClick={() => setInputMode('voice')}\n                  className={`px-4 py-2 rounded-lg transition duration-300 ${\n                    inputMode === 'voice' ? 'bg-black text-white' : 'bg-white text-black'\n                  }`}\n                >\n                  Voice\n                </button>\n                <button\n                  onClick={resetConversation}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  <RefreshCw size={20} />\n                </button>\n                <button\n                  onClick={() => {\n                    if (speechManagerRef.current) {\n                      speechManagerRef.current.stop();\n                    }\n                    setIsMuted(!isMuted);\n                  }}\n                  className=\"bg-white text-black px-4 py-2 rounded-lg hover:bg-gray-200 transition duration-300\"\n                >\n                  {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\n                </button>\n              </div>\n            </div>\n            \n            {/* Divider Line */}\n            <div className=\"h-px bg-black/10\" />\n          </div>\n        </div>\n      </div>\n\n      {/* Main Container */}\n      <div className=\"flex-1 flex h-[calc(100vh-theme(spacing.24))] w-full\">\n        {/* Image and Chat Container */}\n        <div className=\"w-full flex h-full\">\n          {/* Budtender Image Section */}\n          <div className=\"hidden md:block md:w-1/3 bg-black relative\">\n            <div className=\"h-full sticky top-0\">\n              <img \n                src=\"/Budtender.webp\" \n                alt=\"Virtual Budtender\" \n                className=\"w-full h-full object-cover\"\n              />\n              {isRecording && (\n                <div className=\"absolute top-0 left-0 right-0 bottom-0 bg-red-500 bg-opacity-20 flex items-center justify-center\">\n                  <div className=\"animate-ping w-4 h-4 bg-red-600 rounded-full\"></div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Chat Section */}\n          <div className=\"w-full md:w-2/3 flex flex-col bg-gradient-to-br from-[#f0b442] to-[#fcaf17]\">\n            {/* Messages - Scrollable */}\n            <div className=\"flex-1 overflow-y-auto custom-scrollbar\">\n              <div className=\"p-6 space-y-4\">\n                {chatHistory.map((msg) => (\n                  <Message\n                    key={msg.id}\n                    message={msg}\n                    isUser={msg.type === 'user'}\n                    onPlayback={togglePlayback}\n                    isPlaying={isPlaying}\n                    playingAudioId={playingAudioId}\n                    isMuted={isMuted}\n                    recommendations={msg.recommendations}\n                    onProductSelect={handleProductSelect}\n                    onLike={(productId) => handleProductFeedback(productId, true)}\n                    onDislike={(productId) => handleProductFeedback(productId, false)}\n                    onCategorySelect={handleSubmit}\n                  />\n                ))}\n                <div ref={chatEndRef} />\n              </div>\n            </div>\n\n            {/* Input Section */}\n            <div className=\"border-t border-black/10 p-6 bg-[#fcaf17]\">\n              {inputMode === 'text' ? (\n                <form onSubmit={handleTextSubmit} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"text\"\n                    value={textInput}\n                    onChange={(e) => setTextInput(e.target.value)}\n                    placeholder=\"Type your message here...\"\n                    className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\"\n                    disabled={isLoading}\n                  />\n                  <button\n                    type=\"submit\"\n                    className=\"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    disabled={isLoading || !textInput.trim()}\n                  >\n                    Send\n                  </button>\n                </form>\n              ) : (\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"flex-grow bg-white rounded-lg p-2 text-black min-h-[40px]\">\n                    {!isSpeechSupported ? (\n                      \"Speech recognition is not supported in your browser. Please use Chrome or Edge.\"\n                    ) : (\n                      currentSpeech || (isRecording ? \"Listening...\" : \"Click the microphone to start speaking...\")\n                    )}\n                  </div>\n                  {isSpeechSupported && (\n                    <button\n                      onClick={toggleRecording}\n                      className={`w-12 h-12 rounded-full flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-[#fcaf17] focus:ring-opacity-75 transition-all duration-300 ${\n                        isRecording \n                          ? 'bg-red-500 animate-pulse' \n                          : 'bg-green-500 hover:bg-green-600'\n                      }`}\n                      disabled={isLoading}\n                    >\n                      <Mic size={24} className=\"text-white\" />\n                    </button>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VirtualBudtender;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}